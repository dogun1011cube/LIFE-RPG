<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LIFE RPG – Hardcore Tower Mode</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <div class="wrap">
    <header class="topbar">
      <div>
        <h1>LIFE RPG – HARDCORE TOWER MODE</h1>
        <div class="sub">공부 시간을 타워 RPG로 변환</div>
      </div>
      <div class="btns">
        <button id="profileBtn" class="ghost">프로필</button>
        <button id="wakeBtn">일어났어 (Day+)</button>
        <button id="endDayBtn">오늘 공부 끝</button>
        <button id="shopBtn">상점</button>
        <button id="resetBtn" class="danger">현재 프로필 초기화</button>
      </div>
    </header>

    <main class="grid">
      <section class="panel">
        <h2>상태</h2>
        <div id="stats" class="stats"></div>

        <h2>공부 입력</h2>
        <div class="form">
          <label>과목</label>
          <div class="subjectRow">
            <select id="subjectSelect"></select>
            <button id="addSubjectOpenBtn" class="ghost" type="button">+ 과목</button>
          </div>
          <div id="addSubjectRow" class="addSubjectRow hidden">
            <input id="newSubjectInput" placeholder="새 과목 이름 (예: 화학2)" />
            <button id="addSubjectBtn" type="button">추가</button>
          </div>
    <label>시간 입력</label>
          <div class="hms">
            <div class="hmsItem">
              <div class="hmsLabel">시간</div>
              <input id="hoursInput" type="number" min="0" step="1" placeholder="0" />
            </div>
            <div class="hmsItem">
              <div class="hmsLabel">분</div>
              <input id="minutesInput" type="number" min="0" step="1" placeholder="0" />
            </div>
            <div class="hmsItem">
              <div class="hmsLabel">초</div>
              <input id="secondsInput" type="number" min="0" step="1" placeholder="0" />
            </div>
          </div>

          <button id="addStudyBtn">추가</button>
        </div>

        <div id="lastDrop" class="drop"></div>
      </section>

      <section class="panel canvasPanel">
        <h2>타워</h2>
        <canvas id="gameCanvas" width="520" height="520"></canvas>
        <div class="hint">보상 시간 종료 시 이 게임 탭은 blocked로 강제 이동</div>
      </section>

      <section class="panel">
        <div style="display:flex; justify-content:space-between; align-items:center; gap:10px;">
          <h2 style="margin:0;">로그</h2>
          <button id="recordsBtn" class="ghost" type="button">기록 관리</button>
        </div>
        <div id="log" class="log"></div>
      </section>
    </main>
  </div>

  <!-- PROFILE OVERLAY -->
  <div id="profileOverlay" class="overlay hidden" aria-hidden="true">
    <div class="modal">
      <div class="modalTop">
        <div>
          <div class="modalTitle">프로필</div>
          <div class="modalSub">프로필마다 진행 상황이 따로 저장돼</div>
        </div>
        <button id="closeProfileBtn" class="ghost">닫기</button>
      </div>

      <div class="profileBox">
        <div class="profileRow">
          <div class="profileLabel">현재</div>
          <div class="profileValue" id="activeProfileLabel">-</div>
        </div>

        <div class="profileRow">
          <div class="profileLabel">전환</div>
          <select id="profileSelect"></select>
          <button id="switchProfileBtn">전환</button>
        </div>

        <div class="profileRow">
          <div class="profileLabel">새로 만들기</div>
          <input id="newProfileName" placeholder="예: 도근, 동생, 친구" />
          <button id="createProfileBtn">생성</button>
        </div>

        <div class="profileRow">
          <div class="profileLabel">복구</div>
          <button id="recoverBtn">이전 데이터 자동 복구</button>
          <div class="hint">진행이 사라졌을 때만 사용</div>
        </div>

        <div class="profileDanger">
          <button id="deleteProfileBtn" class="danger">현재 프로필 삭제</button>
          <div class="hint">삭제하면 그 프로필 데이터는 복구 불가</div>
        </div>
      </div>
    </div>
  </div>

  <!-- SHOP OVERLAY -->
  <div id="shopOverlay" class="overlay hidden" aria-hidden="true">
    <div class="modal">
      <div class="modalTop">
        <div>
          <div class="modalTitle">상점</div>
          <div class="modalSub">Gold로 보상 시간(분)을 구매하고, 원하는 사이트로 이동</div>
        </div>
        <button id="closeShopBtn" class="ghost">닫기</button>
      </div>

      <div class="form" style="margin-top:10px;">
        <label>보상으로 열 사이트 URL</label>
        <input id="rewardUrlInput" placeholder="예: https://www.youtube.com" />
        <label style="display:flex; gap:10px; align-items:center; margin-top:6px;">
          <input id="sameTabToggle" type="checkbox" />
          <span>같은 탭으로 열기(시간 끝나면 <b>확실히</b> blocked로 강제 복귀)</span>
        </label>
      </div>

      <div class="shopGrid">
        <button class="shopItem" data-min="30" data-price="100">
          <div class="siTitle">보상 30분</div>
          <div class="siDesc">원하는 사이트로 이동</div>
          <div class="siPrice">100G</div>
        </button>
        <button class="shopItem" data-min="20" data-price="80">
          <div class="siTitle">보상 20분</div>
          <div class="siDesc">원하는 사이트로 이동</div>
          <div class="siPrice">80G</div>
        </button>
        <button class="shopItem" data-min="10" data-price="50">
          <div class="siTitle">보상 10분</div>
          <div class="siDesc">원하는 사이트로 이동</div>
          <div class="siPrice">50G</div>
        </button>
        <button class="shopItem test" data-min="1" data-price="0">
          <div class="siTitle">테스트 1분</div>
          <div class="siDesc">차단 이동 테스트</div>
          <div class="siPrice">0G</div>
        </button>
      </div>

      <div class="shopInfo" id="shopInfo"></div>
      <div class="hint">
        🔥 <b>같은 탭 모드</b>는 시간이 끝나면 그 탭을 blocked로 보내기 때문에 “강제 복귀” 체감이 제일 강해.<br/>
        (대신 게임 화면은 보상 중에는 안 보임)
      </div>
    </div>
  </div>

  <!-- REWARD OVERLAY -->
  <div id="rewardOverlay" class="overlay hidden" aria-hidden="true">
    <div class="modal">
      <div class="modalTop">
        <div>
          <div class="modalTitle">보상 모드</div>
          <div class="modalSub">남은 시간이 끝나면 blocked로 이동</div>
        </div>
        <button id="closeRewardBtn" class="ghost">닫기</button>
      </div>

      <div class="rewardBox">
        <div class="rewardName" id="rewardName">-</div>
        <div class="rewardTime" id="rewardTime">00:00</div>
        <div class="rewardActions">
          <button id="openRewardSiteBtn">사이트 열기(재시도)</button>
          <button id="stopRewardBtn" class="danger">종료</button>
        </div>
        <div class="rewardNote">
          ※ 새 탭 모드에서만 “재시도”가 의미가 있어. 같은 탭 모드면 구매 즉시 이동.
        </div>
      </div>
    </div>
  </div>


  <!-- RECORDS OVERLAY -->
  <div id="recordsOverlay" class="overlay hidden" aria-hidden="true">
    <div class="modal">
      <div class="modalTop">
        <div>
          <div class="modalTitle">기록 관리</div>
          <div class="modalSub">삭제할 기록을 직접 선택할 수 있어 (삭제하면 XP/Gold/층도 같이 되돌아감)</div>
        </div>
        <button id="closeRecordsBtn" class="ghost">닫기</button>
      </div>

      <div class="recordsTools">
        <input id="recordsSearch" placeholder="과목 검색 (예: 화학2)" />
        <label class="recordsCheck"><input type="checkbox" id="recordsSelectAll" /> 전체 선택</label>
        <button id="deleteSelectedBtn" class="danger">선택 삭제</button>
      </div>

      <div id="recordsList" class="recordsList"></div>
      <div class="hint">※ 최근 200개까지 표시</div>
    </div>
  </div>


  <!-- BOSS OVERLAY -->
  <div id="bossOverlay" class="overlay hidden" aria-hidden="true">
    <div class="modal boss">
      <div class="bossTitle">21F – 거대 슬라임 출현!</div>
      <div class="bossDesc">승리 시 레벨업 확정</div>
      <div class="bossActions">
        <button id="bossFightBtn">전투 개시</button>
      </div>
    </div>
  </div>

  <script src="main.js"></script>
</body>
</html>
